#!/usr/bin/env bash
#
# Displaying releases metadata
# to pick which release to rollout
#
# Author: lovetravelsfaster
# Date: 2025-12-01
# License: MIT


ssh deploy@lakelabs 'bash -s' << '"EOF"'
release_log="/srv/www/clauslol/releases/release_log.txt"
while IFS=$'\t' read -r release_id description || [[ -n "$release_id" ]]; do
    # Skip empty lines
    [[ -z "$release_id" ]] && continue

    # Skip comments (header line)
    [[ "$release_id" == \#* ]] && continue

    # Strip possible CR from Windows-style line endings
    description=${description%$'\r'}

    printf 'Release ID: %s\n' "$release_id"
    printf '\tDescription: %s\n' "$description"
done < "$release_log"
"EOF"